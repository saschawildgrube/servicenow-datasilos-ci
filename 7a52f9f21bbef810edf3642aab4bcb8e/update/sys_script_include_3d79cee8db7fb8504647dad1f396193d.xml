<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_script_include">
    <sys_script_include action="INSERT_OR_UPDATE">
        <access>public</access>
        <active>true</active>
        <api_name>x_snc_datasilosci.DataSilosGetRelatedRecords</api_name>
        <caller_access>1</caller_access>
        <client_callable>false</client_callable>
        <description>The DataSilosGetRelatedRecords function is called by the DataSilos extension point instance class and returns an array of related records to the given record. If the record does not have any related records the function should return an empty array. If the function returns false, the default DataSilos function or other extensions will provide the related records.</description>
        <name>DataSilosGetRelatedRecords</name>
        <script><![CDATA[function DataSilosGetRelatedRecords(record)
{
	var IsValidRecord = x_snc_devtools.IsValidRecord;
	var RenderValue = x_snc_devtools.RenderValue;
	var GetStringValue = x_snc_devtools.GetStringValue;
	var GetRecord = x_snc_devtools.GetRecord;

	var aRelatedRecords = [];

	var strTable = x_snc_datasilos.GetSupportedTableFromRecord(record);

	if (strTable == 'cmdb_ci')
	{
		var grCRC = new GlideRecord('cmdb_rel_ci')
		var condition = grCRC.addQuery('parent','=',record.sys_id);
		condition.addOrCondition('child','=',record.sys_id);
		grCRC.query();
		while (grCRC.next())
		{
			var strSysId = '';
			if (grCRC.parent == record.sys_id)
			{
				strSysId = GetStringValue(grCRC.child);
			}
			else if (grCRC.child == record.sys_id)
			{
				strSysId = GetStringValue(grCRC.parent);
			}
			var grRecord = GetRecord('cmdb_ci',strSysId);
			if (IsValidRecord(grRecord) == true)
			{
				aRelatedRecords.push(grRecord);
			}
		}
		/*Debug('DataSilosGetRelatedRecords: '+record.name);
		if (aRelatedRecords.length > 0)
		{
			Debug('DataSilosGetRelatedRecords: '+RenderValue(aRelatedRecords));
		}*/
		return aRelatedRecords;
	}
	
	return false;
}]]></script>
        <sys_class_name>sys_script_include</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2021-11-10 08:44:56</sys_created_on>
        <sys_id>3d79cee8db7fb8504647dad1f396193d</sys_id>
        <sys_mod_count>9</sys_mod_count>
        <sys_name>DataSilosGetRelatedRecords</sys_name>
        <sys_package display_value="DataSilosCI WORK IN PROGRESS" source="x_snc_datasilosci">7a52f9f21bbef810edf3642aab4bcb8e</sys_package>
        <sys_policy/>
        <sys_scope display_value="DataSilosCI WORK IN PROGRESS">7a52f9f21bbef810edf3642aab4bcb8e</sys_scope>
        <sys_update_name>sys_script_include_3d79cee8db7fb8504647dad1f396193d</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2021-11-24 12:07:44</sys_updated_on>
    </sys_script_include>
</record_update>
